MESSAGE(STATUS "        Compiling main_subdir: seims_mpi...")
PROJECT(SEIMS_MAIN_MPI_VERSION)
SET(EXECNAME seims_mpi)
# Add ModelMain class
SET(OMP_DIR ${CMAKE_CURRENT_SOURCE_DIR}/../main_omp)
# Add combine raster function
SET(COMBINE_DIR ${CMAKE_CURRENT_SOURCE_DIR}/../../../combine_raster)
geo_include_directories(${COMBINE_DIR} ${OMP_DIR} ${MPI_INCLUDE_PATH})
FILE(GLOB SRC_LIST *.cpp *.h ${OMP_DIR}/ModelMain.cpp ${COMBINE_DIR}/CombineRaster.cpp)
ADD_EXECUTABLE(${EXECNAME} ${SRC_LIST})
SET_TARGET_PROPERTIES(${EXECNAME} PROPERTIES DEBUG_POSTFIX ${CMAKE_DEBUG_POSTFIX})
SET(EXECUTABLE_OUTPUT_PATH ${SEIMS_BINARY_OUTPUT_PATH})
TARGET_LINK_LIBRARIES(${EXECNAME} ${CCGLNAME} util data bmps module_setting ${GDAL_LIBRARIES} ${BSON_LIBRARIES} ${MONGOC_LIBRARIES} ${MPI_LIBRARIES} ${CMAKE_DL_LIBS})
### For Xcode generator, specific LLVM-Clang installed by brew, and add link library of OpenMP explicitly.
IF(XCODE AND LLVM_FOUND)
    TARGET_LINK_LIBRARIES(${EXECNAME} ${OpenMP_LIBRARY})
    SET_TARGET_PROPERTIES(${EXECNAME} PROPERTIES XCODE_ATTRIBUTE_CC ${LLVM_ROOT_DIR}/bin/clang)
    SET_TARGET_PROPERTIES(${EXECNAME} PROPERTIES XCODE_ATTRIBUTE_CXX ${LLVM_ROOT_DIR}/bin/clang++)
    SET_TARGET_PROPERTIES(${EXECNAME} PROPERTIES XCODE_ATTRIBUTE_COMPILER_INDEX_STORE_ENABLE "No")
ENDIF()

INSTALL(TARGETS ${EXECNAME} DESTINATION ${INSTALL_DIR})
# VS2010 has MPI debug tool and seims_mpi should not included in folder
IF(XCODE OR (MSVC AND NOT MSVC10))
    SET_PROPERTY(TARGET ${EXECNAME} PROPERTY FOLDER "main")
ENDIF ()
